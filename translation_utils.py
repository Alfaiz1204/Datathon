from typing import List, Dict
from deep_translator import GoogleTranslator
import re

manual_translation_en_to_id: Dict[str, str] = {}
manual_translation_id_to_en: Dict[str, str] = {}

def _alias_keys(txt: str) -> List[str]:
    base = txt.strip().lower()
    return list({base, base.replace('_',' '), base.replace(' ','_')})

def add_manual_translation(en_text: str, id_text: str):
    for k in _alias_keys(en_text):
        manual_translation_en_to_id[k] = id_text.strip()
    for k in _alias_keys(id_text):
        manual_translation_id_to_en[k] = en_text.strip()

add_manual_translation("muscle_wasting", "penyusutan otot")
add_manual_translation("burning_micturition", "rasa terbakar saat buang air kecil")
add_manual_translation("ulcers_on_tongue", "luka pada lidah")
add_manual_translation("spotting_urination", "bercak darah saat buang air kecil")
add_manual_translation("cold_hands_and_feets", "tangan dan kaki terasa dingin")
add_manual_translation("patches_in_throat", "bercak di tenggorokan")
add_manual_translation("yellowing_of_eyes", "mata menguning")
add_manual_translation("malaise", "rasa tidak enak badan")
add_manual_translation("redness_of_eyes", "kemerahan pada mata")
add_manual_translation("weakness_in_limbs", "kelemahan pada anggota tubuh")
add_manual_translation("bloody_stool", "tinja berdarah")
add_manual_translation("enlarged_thyroid", "pembesaran kelenjar tiroid")
add_manual_translation("swollen_extremeties", "pembengkakan pada tungkai")
add_manual_translation("extra_marital_contacts", "kontak seksual di luar pernikahan")
add_manual_translation("slurred_speech", "bicara pelo")
add_manual_translation("spinning_movements", "gerakan berputar")
add_manual_translation("loss_of_balance", "kehilangan keseimbangan")
add_manual_translation("loss_of_smell", "kehilangan indera penciuman")
add_manual_translation("continuous_feel_of_urine", "terus-menerus merasa ingin buang air kecil")
add_manual_translation("passage_of_gases", "buang gas (kentut)")
add_manual_translation("toxic_look_(typhos)", "penampakan toksik (demam tifoid)")
add_manual_translation("irritability", "mudah tersinggung")
add_manual_translation("altered_sensorium", "perubahan kesadaran")
add_manual_translation("dischromic _patches", "bercak perubahan warna kulit")
add_manual_translation("watering_from_eyes", "keluar air mata terus-menerus")
add_manual_translation("mucoid_sputum", "dahak berlendir")
add_manual_translation("rusty_sputum", "dahak berwarna karat")
add_manual_translation("prominent_veins_on_calf", "pembuluh darah menonjol pada betis")
add_manual_translation("pus_filled_pimples", "jerawat berisi nanah")
add_manual_translation("blackheads", "komedo hitam")
add_manual_translation("scurring", "keropeng")
add_manual_translation("silver_like_dusting", "sisik seperti debu perak")
add_manual_translation("inflammatory_nails", "peradangan pada kuku")
add_manual_translation("red_sore_around_nose", "luka merah di sekitar hidung")
add_manual_translation("yellow_crust_ooze", "kerak kuning yang mengeluarkan cairan")
add_manual_translation("diziness", "pusing")
add_manual_translation("Hypertension", "Hipertensi")
add_manual_translation("itching",                     "gatal")
add_manual_translation("itching",                     "gatel")
add_manual_translation("itching",                     "rasa gatal")
add_manual_translation("skin_rash",                   "ruam kulit")
add_manual_translation("skin_rash",                   "bintik‑bintik merah")
add_manual_translation("nodal_skin_eruptions",        "benjolan pada kulit")
add_manual_translation("nodal_skin_eruptions",        "erupsi nodul kulit")
add_manual_translation("continuous_sneezing",         "bersin terus‑menerus")
add_manual_translation("shivering",                   "menggigil")
add_manual_translation("chills",                      "meriang")
add_manual_translation("skin_peeling",                "kulit mengelupas")
add_manual_translation("silver_like_dusting",         "sisik keperakan")
add_manual_translation("small_dents_in_nails",        "lekuk kecil di kuku")
add_manual_translation("red_spots_over_body",         "bintik merah di tubuh")
add_manual_translation("joint_pain",                  "nyeri sendi")
add_manual_translation("back_pain",                   "nyeri punggung")
add_manual_translation("neck_pain",                   "nyeri leher")
add_manual_translation("knee_pain",                   "nyeri lutut")
add_manual_translation("hip_joint_pain",              "nyeri panggul")
add_manual_translation("muscle_pain",                 "nyeri otot")
add_manual_translation("muscle_weakness",             "otot lemah")
add_manual_translation("weakness_in_limbs",           "kelemahan anggota tubuh")
add_manual_translation("weakness_in_limbs",           "lemas di tangan/kaki")
add_manual_translation("swelling_joints",             "sendi bengkak")
add_manual_translation("swollen_legs",                "kaki bengkak")
add_manual_translation("cramps",                      "kram")
add_manual_translation("movement_stiffness",          "kaku saat bergerak")
add_manual_translation("stiff_neck",                  "leher kaku")
add_manual_translation("painful_walking",             "jalan terasa nyeri")
add_manual_translation("stomach_pain",                "sakit perut")
add_manual_translation("abdominal_pain",              "nyeri perut")
add_manual_translation("acidity",                     "asam lambung")
add_manual_translation("indigestion",                 "gangguan pencernaan")
add_manual_translation("ulcers_on_tongue",            "luka di lidah")
add_manual_translation("vomiting",                    "muntah")
add_manual_translation("nausea",                      "mual")
add_manual_translation("diarrhoea",                   "diare")
add_manual_translation("constipation",                "sembelit")
add_manual_translation("passage_of_gases",            "sering kentut")
add_manual_translation("passage_of_gases",            "ngentut")
add_manual_translation("passage_of_gases",            "mengentut")
add_manual_translation("belly_pain",                  "sakit perut bagian bawah")
add_manual_translation("stomach_bleeding",            "perdarahan lambung")
add_manual_translation("distention_of_abdomen",       "perut kembung/besar")
add_manual_translation("fluid_overload",              "penumpukan cairan tubuh")
add_manual_translation("burning_micturition",         "nyeri saat buang air kecil")
add_manual_translation("burning_micturition",         "rasa terbakar saat BAK")
add_manual_translation("bladder_discomfort",          "rasa tidak nyaman di kandung kemih")
add_manual_translation("continuous_feel_of_urine",    "sering ingin BAK")
add_manual_translation("foul_smell_of urine",         "urine berbau menyengat")
add_manual_translation("yellow_urine",                "urine berwarna kuning gelap")
add_manual_translation("dark_urine",                  "urine gelap")
add_manual_translation("spotting_urination",          "bercak darah saat BAK")
add_manual_translation("polyuria",                    "sering buang air kecil")
add_manual_translation("cough",                       "batuk")
add_manual_translation("high_fever",                  "demam tinggi")
add_manual_translation("breathlessness",              "sesak napas")
add_manual_translation("phlegm",                      "dahak")
add_manual_translation("mucoid_sputum",               "dahak berlendir")
add_manual_translation("rusty_sputum",                "dahak kecokelatan")
add_manual_translation("pain_behind_the_eyes",        "sakit di belakang mata")
add_manual_translation("throat_irritation",           "iritasi tenggorokan")
add_manual_translation("congestion",                  "hidung tersumbat")
add_manual_translation("runny_nose",                  "hidung berair")
add_manual_translation("sinus_pressure",              "tekanan sinus")
add_manual_translation("loss_of_smell",               "hilang penciuman")
add_manual_translation("chest_pain",                  "nyeri dada")
add_manual_translation("blurred_and_distorted_vision","penglihatan kabur")
add_manual_translation("visual_disturbances",         "gangguan penglihatan")
add_manual_translation("dizziness",                   "pusing")
add_manual_translation("dizziness",                   "kepala ringan")
add_manual_translation("spinning_movements",          "sensasi berputar")
add_manual_translation("unsteadiness",                "goyah")
add_manual_translation("loss_of_balance",             "hilang keseimbangan")
add_manual_translation("headache",                    "sakit kepala")
add_manual_translation("slurred_speech",              "bicara pelo")
add_manual_translation("weakness_of_one_body_side",   "kelemahan satu sisi tubuh")
add_manual_translation("altered_sensorium",           "kesadaran menurun")
add_manual_translation("watering_from_eyes",          "air mata terus‑menerus")
add_manual_translation("redness_of_eyes",             "mata merah")
add_manual_translation("blister",                     "lepuh")
add_manual_translation("red_sore_around_nose",        "luka merah di sekitar hidung")
add_manual_translation("yellow_crust_ooze",           "kerak kuning bernanah")
add_manual_translation("pus_filled_pimples",          "jerawat bernanah")
add_manual_translation("blackheads",                  "komedo")
add_manual_translation("scurring",                    "keropeng")
add_manual_translation("irregular_sugar_level",       "gula darah tidak terkontrol")
add_manual_translation("excessive_hunger",            "nafsu makan berlebihan")
add_manual_translation("increased_appetite",          "selera makan meningkat")
add_manual_translation("weight_gain",                 "berat badan naik")
add_manual_translation("weight_loss",                 "berat badan turun")
add_manual_translation("brittle_nails",               "kuku rapuh")
add_manual_translation("enlarged_thyroid",            "pembesaran tiroid")
add_manual_translation("swollen_extremeties",         "bengkak di tungkai")
add_manual_translation("puffy_face_and_eyes",         "wajah & mata bengkak")
add_manual_translation("abnormal_menstruation",       "menstruasi tidak teratur")
add_manual_translation("mood_swings",                 "perubahan suasana hati")
add_manual_translation("anxiety",                     "cemas")
add_manual_translation("depression",                  "depresi")
add_manual_translation("irritability",                "mudah marah")
add_manual_translation("fast_heart_rate",             "detak jantung cepat")
add_manual_translation("palpitations",                "jantung berdebar")
add_manual_translation("bruising",                    "memar")
add_manual_translation("obesity",                     "kegemukan")
add_manual_translation("family_history",              "riwayat keluarga")
add_manual_translation("receiving_blood_transfusion", "menerima transfusi darah")
add_manual_translation("receiving_unsterile_injections","suntikan tidak steril")
add_manual_translation("history_of_alcohol_consumption","riwayat konsumsi alkohol")
add_manual_translation("coma",                        "koma")
add_manual_translation("fluid_overload.1",            "kelebihan cairan")
add_manual_translation("blood_in_sputum",             "darah dalam dahak")
add_manual_translation("pain_during_bowel_movements", "nyeri saat BAB")
add_manual_translation("pain_in_anal_region",         "nyeri di anus")
add_manual_translation("irritation_in_anus",          "iritasi anus")
add_manual_translation("bloody_stool",                "feses berdarah")
add_manual_translation("muscle_wasting",              "penyusutan otot")
add_manual_translation("malaise",                     "rasa tidak enak badan")
add_manual_translation("fluid_overload",              "kelebihan cairan")
add_manual_translation("mild_fever",                  "demam ringan")
add_manual_translation("yellowish_skin",              "kulit menguning")
add_manual_translation("acute_liver_failure",         "gagal hati akut")
add_manual_translation("swelling_of_stomach",         "perut bengkak")
add_manual_translation("sunken_eyes",                 "mata cekung")
add_manual_translation("loss_of_appetite",            "hilang nafsu makan")
add_manual_translation("lack_of_concentration",       "sulit berkonsentrasi")
add_manual_translation("internal_itching",            "gatal dari dalam")
add_manual_translation("watering_from_eyes",          "keluar air mata terus‑menerus")
add_manual_translation("pain_behind_the_eyes",        "sakit belakang mata")
add_manual_translation("runny_nose",                  "ingus")
add_manual_translation("congestion",                  "hidung tersumbat")
add_manual_translation("sinus_pressure",              "tekanan sinus")
add_manual_translation("diziness",                    "pusing")
add_manual_translation("dizziness",                   "pusing berputar")
add_manual_translation("Hypertension",                "hipertensi")
add_manual_translation("acute_liver_failure", "gagal hati akut")
add_manual_translation("acute_liver_failure", "kerusakan hati mendadak")
add_manual_translation("fluid_overload", "kelebihan cairan tubuh")
add_manual_translation("fluid_overload", "retensi cairan berlebihan")
add_manual_translation("swelling_of_stomach", "pembengkakan perut")
add_manual_translation("swelling_of_stomach", "perut buncit")
add_manual_translation("swelled_lymph_nodes", "pembengkakan kelenjar getah bening")
add_manual_translation("swelled_lymph_nodes", "kelenjar getah bening bengkak")
add_manual_translation("blurred_and_distorted_vision", "penglihatan kabur dan tidak jelas")
add_manual_translation("blurred_and_distorted_vision", "penglihatan buram")
add_manual_translation("phlegm", "dahak")
add_manual_translation("phlegm", "lendir tenggorokan")
add_manual_translation("throat_irritation", "iritasi tenggorokan")
add_manual_translation("throat_irritation", "tenggorokan terasa gatal")
add_manual_translation("sinus_pressure", "tekanan pada sinus")
add_manual_translation("sinus_pressure", "rasa penuh di wajah atau kepala")
add_manual_translation("runny_nose", "hidung meler")
add_manual_translation("runny_nose", "ingus keluar terus")
add_manual_translation("congestion", "hidung tersumbat")
add_manual_translation("congestion", "sumbatan di hidung")
add_manual_translation("chest_pain", "nyeri dada")
add_manual_translation("chest_pain", "dada terasa sakit")
add_manual_translation("fast_heart_rate", "detak jantung cepat")
add_manual_translation("fast_heart_rate", "jantung berdebar")
add_manual_translation("pain_during_bowel_movements", "nyeri saat buang air besar")
add_manual_translation("pain_during_bowel_movements", "BAB terasa sakit")
add_manual_translation("pain_in_anal_region", "nyeri di anus")
add_manual_translation("pain_in_anal_region", "sakit di sekitar dubur")
add_manual_translation("irritation_in_anus", "iritasi pada anus")
add_manual_translation("irritation_in_anus", "anus terasa gatal")
add_manual_translation("cramps", "kram")
add_manual_translation("cramps", "otot kejang")
add_manual_translation("bruising", "memar")
add_manual_translation("bruising", "lebam")
add_manual_translation("obesity", "obesitas")
add_manual_translation("obesity", "kelebihan berat badan")
add_manual_translation("swollen_legs", "kaki bengkak")
add_manual_translation("swollen_legs", "pembengkakan di kaki")
add_manual_translation("swollen_blood_vessels", "pembuluh darah bengkak")
add_manual_translation("puffy_face_and_eyes", "wajah dan mata bengkak")
add_manual_translation("brittle_nails", "kuku rapuh")
add_manual_translation("brittle_nails", "kuku mudah patah")
add_manual_translation("excessive_hunger", "terlalu lapar")
add_manual_translation("excessive_hunger", "nafsu makan berlebihan")
add_manual_translation("drying_and_tingling_lips", "bibir kering dan kesemutan")
add_manual_translation("knee_pain", "nyeri lutut")
add_manual_translation("knee_pain", "lutut sakit")
add_manual_translation("hip_joint_pain", "nyeri sendi panggul")
add_manual_translation("muscle_weakness", "kelemahan otot")
add_manual_translation("stiff_neck", "leher kaku")
add_manual_translation("swelling_joints", "pembengkakan sendi")
add_manual_translation("movement_stiffness", "gerakan kaku")
add_manual_translation("movement_stiffness", "tidak leluasa bergerak")
add_manual_translation("unsteadiness", "tidak seimbang")
add_manual_translation("weakness_of_one_body_side", "kelemahan pada satu sisi tubuh")
add_manual_translation("bladder_discomfort", "ketidaknyamanan kandung kemih")
add_manual_translation("foul_smell_of urine", "bau urine menyengat")
add_manual_translation("internal_itching", "gatal dari dalam tubuh")
add_manual_translation("depression", "depresi")
add_manual_translation("depression", "rasa sedih mendalam")
add_manual_translation("muscle_pain", "nyeri otot")
add_manual_translation("red_spots_over_body", "bintik merah di tubuh")
add_manual_translation("belly_pain", "sakit perut")
add_manual_translation("abnormal_menstruation", "menstruasi tidak normal")
add_manual_translation("increased_appetite", "nafsu makan meningkat")
add_manual_translation("polyuria", "sering buang air kecil")
add_manual_translation("family_history", "riwayat keluarga")
add_manual_translation("lack_of_concentration", "sulit berkonsentrasi")
add_manual_translation("visual_disturbances", "gangguan penglihatan")
add_manual_translation("receiving_blood_transfusion", "pernah transfusi darah")
add_manual_translation("receiving_unsterile_injections", "suntikan tidak steril")
add_manual_translation("coma", "koma")
add_manual_translation("stomach_bleeding", "perdarahan lambung")
add_manual_translation("distention_of_abdomen", "perut kembung")
add_manual_translation("history_of_alcohol_consumption", "riwayat konsumsi alkohol")
add_manual_translation("fluid_overload.1", "kelebihan cairan tubuh")
add_manual_translation("blood_in_sputum", "darah dalam dahak")
add_manual_translation("palpitations", "jantung berdebar")
add_manual_translation("painful_walking", "jalan terasa sakit")
add_manual_translation("skin_peeling", "kulit mengelupas")
add_manual_translation("small_dents_in_nails", "cekungan kecil pada kuku")
add_manual_translation("blister", "lepuh")

def to_en(text: str) -> str:
    for k in _alias_keys(text.lower()):
        if k in manual_translation_id_to_en:
            return manual_translation_id_to_en[k]
    try:
        return GoogleTranslator(source="auto", target="en").translate(text)
    except Exception:
        return text

def to_id(text: str) -> str:
    for k in _alias_keys(text.lower()):
        if k in manual_translation_en_to_id:
            return manual_translation_en_to_id[k]
    try:
        parts = re.split(r'(?<=[.!?]) +', text.strip())
        return ' '.join(GoogleTranslator(source="en", target="id").translate(p) for p in parts if p)
    except Exception:
        return text
